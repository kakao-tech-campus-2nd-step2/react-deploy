{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useInfiniteQuery } from '@tanstack/react-query';\nimport { useBackend } from '@/provider/Auth/Backend';\nimport { fetchInstance } from '../instance';\nconst getProductsPath = ({\n  categoryId,\n  pageToken,\n  maxResults\n}) => {\n  const params = new URLSearchParams();\n  params.append('categoryId', categoryId);\n  params.append('sort', 'name,asc');\n  if (pageToken) params.append('page', pageToken);\n  if (maxResults) params.append('size', maxResults.toString());\n  return `/api/products?${params.toString()}`;\n};\nexport const getProducts = async params => {\n  _s();\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const {\n    backendUrl\n  } = useBackend();\n  const response = await fetchInstance(backendUrl).get(getProductsPath(params));\n  const data = response.data;\n  return {\n    products: data.content,\n    nextPageToken: data.last === false ? (data.number + 1).toString() : undefined,\n    pageInfo: {\n      totalResults: data.totalElements,\n      resultsPerPage: data.size\n    }\n  };\n};\n_s(getProducts, \"o76kCyLQxltR5B6VSS6TgnxlI7w=\", false, function () {\n  return [useBackend];\n});\nexport const useGetProducts = ({\n  categoryId,\n  maxResults = 20,\n  initPageToken\n}) => {\n  _s2();\n  return useInfiniteQuery({\n    queryKey: ['products', categoryId, maxResults, initPageToken],\n    queryFn: async ({\n      pageParam = initPageToken\n    }) => {\n      return getProducts({\n        categoryId,\n        pageToken: pageParam,\n        maxResults\n      });\n    },\n    initialPageParam: initPageToken,\n    getNextPageParam: lastPage => lastPage.nextPageToken\n  });\n};\n_s2(useGetProducts, \"xMCOiuh9cV5e8gBi6hogZoGnISk=\", false, function () {\n  return [useInfiniteQuery];\n});","map":{"version":3,"names":["useInfiniteQuery","useBackend","fetchInstance","getProductsPath","categoryId","pageToken","maxResults","params","URLSearchParams","append","toString","getProducts","_s","backendUrl","response","get","data","products","content","nextPageToken","last","number","undefined","pageInfo","totalResults","totalElements","resultsPerPage","size","useGetProducts","initPageToken","_s2","queryKey","queryFn","pageParam","initialPageParam","getNextPageParam","lastPage"],"sources":["C:/Users/jihwan/projects/react-deploy/src/api/hooks/useGetProducts.ts"],"sourcesContent":["import { useInfiniteQuery, type UseInfiniteQueryResult } from '@tanstack/react-query';\r\n\r\nimport { useBackend } from '@/provider/Auth/Backend';\r\nimport type { ProductData } from '@/types';\r\n\r\nimport { fetchInstance } from '../instance';\r\n\r\ntype RequestParams = {\r\n  categoryId: string;\r\n  pageToken?: string;\r\n  maxResults?: number;\r\n};\r\n\r\ntype ProductsResponseData = {\r\n  products: ProductData[];\r\n  nextPageToken?: string;\r\n  pageInfo: {\r\n    totalResults: number;\r\n    resultsPerPage: number;\r\n  };\r\n};\r\n\r\ntype ProductsResponseRawData = {\r\n  content: ProductData[];\r\n  number: number;\r\n  totalElements: number;\r\n  size: number;\r\n  last: boolean;\r\n};\r\n\r\nconst getProductsPath = ({ categoryId, pageToken, maxResults }: RequestParams) => {\r\n  const params = new URLSearchParams();\r\n\r\n  params.append('categoryId', categoryId);\r\n  params.append('sort', 'name,asc');\r\n  if (pageToken) params.append('page', pageToken);\r\n  if (maxResults) params.append('size', maxResults.toString());\r\n\r\n  return `/api/products?${params.toString()}`;\r\n};\r\n\r\nexport const getProducts = async (params: RequestParams): Promise<ProductsResponseData> => {\r\n  // eslint-disable-next-line react-hooks/rules-of-hooks\r\n  const { backendUrl } = useBackend();\r\n  const response = await fetchInstance(backendUrl).get<ProductsResponseRawData>(\r\n    getProductsPath(params),\r\n  );\r\n  const data = response.data;\r\n\r\n  return {\r\n    products: data.content,\r\n    nextPageToken: data.last === false ? (data.number + 1).toString() : undefined,\r\n    pageInfo: {\r\n      totalResults: data.totalElements,\r\n      resultsPerPage: data.size,\r\n    },\r\n  };\r\n};\r\n\r\ntype Params = Pick<RequestParams, 'maxResults' | 'categoryId'> & { initPageToken?: string };\r\n\r\nexport const useGetProducts = ({\r\n  categoryId,\r\n  maxResults = 20,\r\n  initPageToken,\r\n}: Params): UseInfiniteQueryResult<ProductsResponseData> => {\r\n  return useInfiniteQuery({\r\n    queryKey: ['products', categoryId, maxResults, initPageToken],\r\n    queryFn: async ({ pageParam = initPageToken }) => {\r\n      return getProducts({ categoryId, pageToken: pageParam, maxResults });\r\n    },\r\n    initialPageParam: initPageToken,\r\n    getNextPageParam: (lastPage) => lastPage.nextPageToken,\r\n  });\r\n};\r\n"],"mappings":";;AAAA,SAASA,gBAAgB,QAAqC,uBAAuB;AAErF,SAASC,UAAU,QAAQ,yBAAyB;AAGpD,SAASC,aAAa,QAAQ,aAAa;AAyB3C,MAAMC,eAAe,GAAGA,CAAC;EAAEC,UAAU;EAAEC,SAAS;EAAEC;AAA0B,CAAC,KAAK;EAChF,MAAMC,MAAM,GAAG,IAAIC,eAAe,CAAC,CAAC;EAEpCD,MAAM,CAACE,MAAM,CAAC,YAAY,EAAEL,UAAU,CAAC;EACvCG,MAAM,CAACE,MAAM,CAAC,MAAM,EAAE,UAAU,CAAC;EACjC,IAAIJ,SAAS,EAAEE,MAAM,CAACE,MAAM,CAAC,MAAM,EAAEJ,SAAS,CAAC;EAC/C,IAAIC,UAAU,EAAEC,MAAM,CAACE,MAAM,CAAC,MAAM,EAAEH,UAAU,CAACI,QAAQ,CAAC,CAAC,CAAC;EAE5D,OAAQ,iBAAgBH,MAAM,CAACG,QAAQ,CAAC,CAAE,EAAC;AAC7C,CAAC;AAED,OAAO,MAAMC,WAAW,GAAG,MAAOJ,MAAqB,IAAoC;EAAAK,EAAA;EACzF;EACA,MAAM;IAAEC;EAAW,CAAC,GAAGZ,UAAU,CAAC,CAAC;EACnC,MAAMa,QAAQ,GAAG,MAAMZ,aAAa,CAACW,UAAU,CAAC,CAACE,GAAG,CAClDZ,eAAe,CAACI,MAAM,CACxB,CAAC;EACD,MAAMS,IAAI,GAAGF,QAAQ,CAACE,IAAI;EAE1B,OAAO;IACLC,QAAQ,EAAED,IAAI,CAACE,OAAO;IACtBC,aAAa,EAAEH,IAAI,CAACI,IAAI,KAAK,KAAK,GAAG,CAACJ,IAAI,CAACK,MAAM,GAAG,CAAC,EAAEX,QAAQ,CAAC,CAAC,GAAGY,SAAS;IAC7EC,QAAQ,EAAE;MACRC,YAAY,EAAER,IAAI,CAACS,aAAa;MAChCC,cAAc,EAAEV,IAAI,CAACW;IACvB;EACF,CAAC;AACH,CAAC;AAACf,EAAA,CAhBWD,WAAW;EAAA,QAECV,UAAU;AAAA;AAkBnC,OAAO,MAAM2B,cAAc,GAAGA,CAAC;EAC7BxB,UAAU;EACVE,UAAU,GAAG,EAAE;EACfuB;AACM,CAAC,KAAmD;EAAAC,GAAA;EAC1D,OAAO9B,gBAAgB,CAAC;IACtB+B,QAAQ,EAAE,CAAC,UAAU,EAAE3B,UAAU,EAAEE,UAAU,EAAEuB,aAAa,CAAC;IAC7DG,OAAO,EAAE,MAAAA,CAAO;MAAEC,SAAS,GAAGJ;IAAc,CAAC,KAAK;MAChD,OAAOlB,WAAW,CAAC;QAAEP,UAAU;QAAEC,SAAS,EAAE4B,SAAS;QAAE3B;MAAW,CAAC,CAAC;IACtE,CAAC;IACD4B,gBAAgB,EAAEL,aAAa;IAC/BM,gBAAgB,EAAGC,QAAQ,IAAKA,QAAQ,CAACjB;EAC3C,CAAC,CAAC;AACJ,CAAC;AAACW,GAAA,CAbWF,cAAc;EAAA,QAKlB5B,gBAAgB;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import{useInfiniteQuery}from'@tanstack/react-query';import{BASE_URL}from'../instance';import{fetchInstance}from'./../instance/index';export const getProductsPath=function(){let{categoryId,pageToken,maxResults}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{categoryId:'',pageToken:'',maxResults:20};const params=new URLSearchParams();if(categoryId)params.append('categoryId',categoryId);params.append('sort','name,asc');if(pageToken)params.append('page',pageToken);if(maxResults)params.append('size',maxResults.toString());return\"\".concat(BASE_URL,\"/api/products?\").concat(params.toString());};export const getProducts=async params=>{const response=await fetchInstance.get(getProductsPath(params));const data=response.data;return{products:data.content,nextPageToken:data.last===false?(data.number+1).toString():undefined,pageInfo:{totalResults:data.totalElements,resultsPerPage:data.size}};};export const useGetProducts=_ref=>{let{categoryId,maxResults=20,initPageToken}=_ref;return useInfiniteQuery({queryKey:['products',categoryId,maxResults,initPageToken],queryFn:async _ref2=>{let{pageParam=initPageToken}=_ref2;return getProducts({categoryId,pageToken:pageParam,maxResults});},initialPageParam:initPageToken,getNextPageParam:lastPage=>lastPage.nextPageToken});};","map":{"version":3,"names":["useInfiniteQuery","BASE_URL","fetchInstance","getProductsPath","categoryId","pageToken","maxResults","arguments","length","undefined","params","URLSearchParams","append","toString","concat","getProducts","response","get","data","products","content","nextPageToken","last","number","pageInfo","totalResults","totalElements","resultsPerPage","size","useGetProducts","_ref","initPageToken","queryKey","queryFn","_ref2","pageParam","initialPageParam","getNextPageParam","lastPage"],"sources":["/Users/kyoungseo/Desktop/4학년/카테캠/step2/kakao-gift5/react-product-login/src/api/hooks/useGetProducts.ts"],"sourcesContent":["import {\n  type InfiniteData,\n  useInfiniteQuery,\n  type UseInfiniteQueryResult,\n} from '@tanstack/react-query';\n\nimport type { ProductData } from '@/types';\n\nimport { BASE_URL } from '../instance';\nimport { fetchInstance } from './../instance/index';\n\ntype RequestParams = {\n  categoryId: string;\n  pageToken?: string;\n  maxResults?: number;\n};\n\ntype ProductsResponseData = {\n  products: ProductData[];\n  nextPageToken?: string;\n  pageInfo: {\n    totalResults: number;\n    resultsPerPage: number;\n  };\n};\n\ntype ProductsResponseRawData = {\n  content: ProductData[];\n  number: number;\n  totalElements: number;\n  size: number;\n  last: boolean;\n};\n\nexport const getProductsPath = (\n  { categoryId, pageToken, maxResults }: RequestParams = {\n    categoryId: '',\n    pageToken: '',\n    maxResults: 20,\n  },\n) => {\n  const params = new URLSearchParams();\n\n  if (categoryId) params.append('categoryId', categoryId);\n  params.append('sort', 'name,asc');\n  if (pageToken) params.append('page', pageToken);\n  if (maxResults) params.append('size', maxResults.toString());\n\n  return `${BASE_URL}/api/products?${params.toString()}`;\n};\n\nexport const getProducts = async (params: RequestParams): Promise<ProductsResponseData> => {\n  const response = await fetchInstance.get<ProductsResponseRawData>(getProductsPath(params));\n  const data = response.data;\n\n  return {\n    products: data.content,\n    nextPageToken: data.last === false ? (data.number + 1).toString() : undefined,\n    pageInfo: {\n      totalResults: data.totalElements,\n      resultsPerPage: data.size,\n    },\n  };\n};\n\ntype Params = Pick<RequestParams, 'maxResults' | 'categoryId'> & { initPageToken?: string };\nexport const useGetProducts = ({\n  categoryId,\n  maxResults = 20,\n  initPageToken,\n}: Params): UseInfiniteQueryResult<InfiniteData<ProductsResponseData>> => {\n  return useInfiniteQuery({\n    queryKey: ['products', categoryId, maxResults, initPageToken],\n    queryFn: async ({ pageParam = initPageToken }) => {\n      return getProducts({ categoryId, pageToken: pageParam, maxResults });\n    },\n    initialPageParam: initPageToken,\n    getNextPageParam: (lastPage) => lastPage.nextPageToken,\n  });\n};\n"],"mappings":"AAAA,OAEEA,gBAAgB,KAEX,uBAAuB,CAI9B,OAASC,QAAQ,KAAQ,aAAa,CACtC,OAASC,aAAa,KAAQ,qBAAqB,CAyBnD,MAAO,MAAM,CAAAC,eAAe,CAAG,QAAAA,CAAA,CAM1B,IALH,CAAEC,UAAU,CAAEC,SAAS,CAAEC,UAA0B,CAAC,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CACrDH,UAAU,CAAE,EAAE,CACdC,SAAS,CAAE,EAAE,CACbC,UAAU,CAAE,EACd,CAAC,CAED,KAAM,CAAAI,MAAM,CAAG,GAAI,CAAAC,eAAe,CAAC,CAAC,CAEpC,GAAIP,UAAU,CAAEM,MAAM,CAACE,MAAM,CAAC,YAAY,CAAER,UAAU,CAAC,CACvDM,MAAM,CAACE,MAAM,CAAC,MAAM,CAAE,UAAU,CAAC,CACjC,GAAIP,SAAS,CAAEK,MAAM,CAACE,MAAM,CAAC,MAAM,CAAEP,SAAS,CAAC,CAC/C,GAAIC,UAAU,CAAEI,MAAM,CAACE,MAAM,CAAC,MAAM,CAAEN,UAAU,CAACO,QAAQ,CAAC,CAAC,CAAC,CAE5D,SAAAC,MAAA,CAAUb,QAAQ,mBAAAa,MAAA,CAAiBJ,MAAM,CAACG,QAAQ,CAAC,CAAC,EACtD,CAAC,CAED,MAAO,MAAM,CAAAE,WAAW,CAAG,KAAO,CAAAL,MAAqB,EAAoC,CACzF,KAAM,CAAAM,QAAQ,CAAG,KAAM,CAAAd,aAAa,CAACe,GAAG,CAA0Bd,eAAe,CAACO,MAAM,CAAC,CAAC,CAC1F,KAAM,CAAAQ,IAAI,CAAGF,QAAQ,CAACE,IAAI,CAE1B,MAAO,CACLC,QAAQ,CAAED,IAAI,CAACE,OAAO,CACtBC,aAAa,CAAEH,IAAI,CAACI,IAAI,GAAK,KAAK,CAAG,CAACJ,IAAI,CAACK,MAAM,CAAG,CAAC,EAAEV,QAAQ,CAAC,CAAC,CAAGJ,SAAS,CAC7Ee,QAAQ,CAAE,CACRC,YAAY,CAAEP,IAAI,CAACQ,aAAa,CAChCC,cAAc,CAAET,IAAI,CAACU,IACvB,CACF,CAAC,CACH,CAAC,CAGD,MAAO,MAAM,CAAAC,cAAc,CAAGC,IAAA,EAI4C,IAJ3C,CAC7B1B,UAAU,CACVE,UAAU,CAAG,EAAE,CACfyB,aACM,CAAC,CAAAD,IAAA,CACP,MAAO,CAAA9B,gBAAgB,CAAC,CACtBgC,QAAQ,CAAE,CAAC,UAAU,CAAE5B,UAAU,CAAEE,UAAU,CAAEyB,aAAa,CAAC,CAC7DE,OAAO,CAAE,MAAAC,KAAA,EAAyC,IAAlC,CAAEC,SAAS,CAAGJ,aAAc,CAAC,CAAAG,KAAA,CAC3C,MAAO,CAAAnB,WAAW,CAAC,CAAEX,UAAU,CAAEC,SAAS,CAAE8B,SAAS,CAAE7B,UAAW,CAAC,CAAC,CACtE,CAAC,CACD8B,gBAAgB,CAAEL,aAAa,CAC/BM,gBAAgB,CAAGC,QAAQ,EAAKA,QAAQ,CAACjB,aAC3C,CAAC,CAAC,CACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}